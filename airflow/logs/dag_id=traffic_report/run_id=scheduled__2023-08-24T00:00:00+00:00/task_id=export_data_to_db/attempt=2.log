[2023-08-30T19:35:44.061+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:35:44.070+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:35:44.077+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:35:44.078+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:35:44.087+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T19:35:44.092+0000] {standard_task_runner.py:57} INFO - Started process 485 to run task
[2023-08-30T19:35:44.094+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpaspdjlrw']
[2023-08-30T19:35:44.103+0000] {standard_task_runner.py:85} INFO - Job 26: Subtask export_data_to_db
[2023-08-30T19:35:44.117+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:35:44.154+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host f6bcf103ff79
[2023-08-30T19:35:44.167+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:35:44.221+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T19:35:44.225+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:35:44.226+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:35:44.237+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:35:44.572+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:35:44.574+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:35:44.575+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:35:44.576+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:35:44.577+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:35:44.579+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:35:44.599+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:35:44.611+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:35:44.615+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T193544, end_date=20230830T193544
[2023-08-30T19:35:44.627+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 26 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 485)
[2023-08-30T19:35:44.641+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:35:44.656+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:44:05.374+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:05.389+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:44:05.399+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:44:05.401+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:44:05.418+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T19:44:05.430+0000] {standard_task_runner.py:57} INFO - Started process 472 to run task
[2023-08-30T19:44:05.434+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '25', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpqglvy33a']
[2023-08-30T19:44:05.445+0000] {standard_task_runner.py:85} INFO - Job 25: Subtask export_data_to_db
[2023-08-30T19:44:05.952+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:11.405+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host 81eeb4b7c8a9
[2023-08-30T19:44:11.451+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:11.560+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T19:44:11.567+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:44:11.571+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:44:11.594+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:44:13.574+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:44:13.580+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:44:13.582+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:44:13.585+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:44:13.587+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:44:13.588+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:44:13.652+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:44:13.702+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:44:13.719+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T194405, end_date=20230830T194413
[2023-08-30T19:44:13.751+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 25 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 472)
[2023-08-30T19:44:13.800+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:44:13.940+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:56:36.803+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:36.813+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:56:36.822+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T19:56:36.823+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:56:36.842+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T19:56:36.847+0000] {standard_task_runner.py:57} INFO - Started process 196 to run task
[2023-08-30T19:56:36.861+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpu32xub1u']
[2023-08-30T19:56:36.876+0000] {standard_task_runner.py:85} INFO - Job 24: Subtask export_data_to_db
[2023-08-30T19:56:36.916+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:36.976+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host 86f9e97d6c70
[2023-08-30T19:56:37.004+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:37.088+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T19:56:37.092+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:56:37.093+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:56:37.109+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:56:37.925+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:56:37.927+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T19:56:37.929+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T19:56:37.929+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 22, in main
[2023-08-30T19:56:37.930+0000] {subprocess.py:93} INFO -     with open(filename, encoding='utf-8') as csvf:
[2023-08-30T19:56:37.931+0000] {subprocess.py:93} INFO - FileNotFoundError: [Errno 2] No such file or directory: '/opt/***/dags/data/dailytraffic_2023-08-23.csv'
[2023-08-30T19:56:38.020+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:56:38.046+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:56:38.053+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T195636, end_date=20230830T195638
[2023-08-30T19:56:38.067+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 24 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 196)
[2023-08-30T19:56:38.078+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:56:38.099+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:08:00.424+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.433+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:08:00.441+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:08:00.443+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:08:00.453+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T20:08:00.459+0000] {standard_task_runner.py:57} INFO - Started process 649 to run task
[2023-08-30T20:08:00.463+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '30', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpd27g4csu']
[2023-08-30T20:08:00.466+0000] {standard_task_runner.py:85} INFO - Job 30: Subtask export_data_to_db
[2023-08-30T20:08:00.480+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.520+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host 3938d7abd9ff
[2023-08-30T20:08:00.534+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.585+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T20:08:00.589+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:08:00.591+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:08:00.602+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:08:01.197+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:08:01.198+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:08:01.200+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:08:01.201+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:08:01.202+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:08:01.203+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:08:01.204+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:08:01.206+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:08:01.207+0000] {subprocess.py:93} INFO - LINE 1: ...3', '2023-08-23 00:03:13+00:00', 'crash service', ST_GeomFro...
[2023-08-30T20:08:01.208+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:08:01.209+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:08:01.211+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.213+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.214+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:08:01.215+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.216+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:08:01.218+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:08:01.219+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:08:01.220+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:08:01.223+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:08:01.224+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:08:01.226+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:08:01.228+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:08:01.232+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:08:01.234+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:08:01.236+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:08:01.237+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:08:01.239+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:08:01.240+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:08:01.242+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:08:01.253+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:08:01.254+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:08:01.255+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:08:01.257+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:08:01.259+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:08:01.260+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:08:01.261+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:08:01.262+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:08:01.263+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:08:01.265+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:08:01.270+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:08:01.272+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:08:01.273+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:08:01.275+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:08:01.279+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:08:01.280+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:08:01.281+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:08:01.282+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:08:01.283+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:08:01.284+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:08:01.286+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:08:01.288+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:08:01.291+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:08:01.293+0000] {subprocess.py:93} INFO - LINE 1: ...3', '2023-08-23 00:03:13+00:00', 'crash service', ST_GeomFro...
[2023-08-30T20:08:01.294+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:08:01.295+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:08:01.296+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.298+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:08:01.299+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1692748993000000000', 'traffic_report_id': '9A6B59DA46371D86EB75259C956AEE4B580C0119_1692748993', 'date_time': '2023-08-23 00:03:13+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.738909 30.193169)', 'latitude': '30.193169', 'longitude': '-97.738909', 'address': 'nuckols crossing rd / e stassney ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:13'}, {'timestamp': '1692749009000000000', 'traffic_report_id': '634DE0A75896238BFD3F5886F6062F00DA3D0B56_1692749009', 'date_time': '2023-08-23 00:03:29+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.790941 30.167145)', 'latitude': '30.167145', 'longitude': '-97.790941', 'address': 'w slaughter ln / cullen ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:29'}, {'timestamp': '1692749887000000000', 'traffic_report_id': 'EBA90709ED04EB27E4A042727D7DD308E44389E4_1692749887', 'date_time': '2023-08-23 00:18:07+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.691583 30.370783)', 'latitude': '30.370783', 'longitude': '-97.691583', 'address': '600 masterson pass', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:18:07'}, {'timestamp': '1692751163000000000', 'traffic_report_id': '9D634E9D726305D5B9A7D2E527F6C49DD3603F4F_1692751163', 'date_time': '2023-08-23 00:39:23+00:00', 'issue_reported': 'collision with injury', 'location': 'POINT(-97.61178 30.102795)', 'latitude': '30.102795', 'longitude': '-97.61178', 'address': 'fm 812 rd / doyle rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:39:23'}, {'timestamp': '1692751987000000000', 'traffic_report_id': '301F839B74B67350B1BDC01050369AEC1F36E0D2_1692751987', 'date_time': '2023-08-23 00:53:07+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.691413 30.328075)', 'latitude': '30.328075', 'longitude': '-97.691413', 'address': '1308 fairbanks dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:53:07'}, {'timestamp': '1692752143000000000', 'traffic_report_id': '2B80090196FBBD61985EA7F2FC5C2F6AA4E1F134_1692752143', 'date_time': '2023-08-23 00:55:43+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.728493 30.235959)', 'latitude': '30.235959', 'longitude': '-97.728493', 'address': 'burton dr / woodland ave', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:55:43'}, {'timestamp': '1692753489000000000', 'traffic_report_id': '1E768A21723E530122240FA219BFF8C3365F40B2_1692753489', 'date_time': '2023-08-23 01:18:09+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.708554 30.310245)', 'latitude': '30.310245', 'longitude': '-97.708554', 'address': '5201-5217 cameron rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:09'}, {'timestamp': '1692753535000000000', 'traffic_report_id': '509F6CCBC5A85A0D07F32BFF32186163BA8301B8_1692753535', 'date_time': '2023-08-23 01:18:55+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.73408 30.26906)', 'latitude': '30.26906', 'longitude': '-97.73408', 'address': '900 n ih 35 svrd sb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:55'}  ... displaying 10 of 146 total bound parameter sets ...  {'timestamp': '1692834773000000000', 'traffic_report_id': '3C457CE18C2E37A4437E0201076AD638367EF0EA_1692834773', 'date_time': '2023-08-23 23:52:53+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.774726 30.183637)', 'latitude': '30.183637', 'longitude': '-97.774726', 'address': '7301 s ih 35 svrd nb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:52:53'}, {'timestamp': '1692834818000000000', 'traffic_report_id': '0F23EB04FA3D66BCE3CB03DE0629AC1B4FD32BBB_1692834818', 'date_time': '2023-08-23 23:53:38+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.742505 30.443741)', 'latitude': '30.443741', 'longitude': '-97.742505', 'address': '6101-6217 mc neil dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:53:38'})]
[2023-08-30T20:08:01.301+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:08:01.303+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:08:01.321+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:08:01.326+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T200800, end_date=20230830T200801
[2023-08-30T20:08:01.342+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 30 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 649)
[2023-08-30T20:08:01.365+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:08:01.398+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:36:03.694+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:03.704+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:36:03.719+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:36:03.722+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:36:03.737+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T20:36:03.748+0000] {standard_task_runner.py:57} INFO - Started process 445 to run task
[2023-08-30T20:36:03.753+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmp8kw2urnw']
[2023-08-30T20:36:03.759+0000] {standard_task_runner.py:85} INFO - Job 23: Subtask export_data_to_db
[2023-08-30T20:36:03.781+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:03.846+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host 961f38e8363e
[2023-08-30T20:36:03.889+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:03.965+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T20:36:03.967+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:36:03.969+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:36:03.979+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:36:04.779+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:36:04.781+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:36:04.783+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:36:04.784+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:36:04.786+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:36:04.788+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:36:04.790+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:36:04.791+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:36:04.793+0000] {subprocess.py:93} INFO - LINE 1: ...3', '2023-08-23 00:03:13+00:00', 'crash service', ST_GeomFro...
[2023-08-30T20:36:04.795+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:36:04.797+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:36:04.799+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:04.800+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:04.800+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:36:04.802+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:04.802+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:36:04.803+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:36:04.804+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:36:04.806+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:36:04.807+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:36:04.808+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:36:04.809+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:36:04.810+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:36:04.811+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:36:04.813+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:36:04.814+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:36:04.816+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:36:04.817+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:36:04.818+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:36:04.818+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:36:04.819+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:36:04.821+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:36:04.822+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:36:04.823+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:36:04.824+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:36:04.826+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:36:04.827+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:36:04.828+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:36:04.829+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:36:04.831+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:36:04.832+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:36:04.833+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:36:04.834+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:36:04.835+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:36:04.837+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:36:04.839+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:36:04.840+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:36:04.841+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:36:04.842+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:36:04.844+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:36:04.845+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:36:04.846+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:36:04.848+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:36:04.849+0000] {subprocess.py:93} INFO - LINE 1: ...3', '2023-08-23 00:03:13+00:00', 'crash service', ST_GeomFro...
[2023-08-30T20:36:04.851+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:36:04.852+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:36:04.853+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:04.856+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:36:04.859+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1692748993000000000', 'traffic_report_id': '9A6B59DA46371D86EB75259C956AEE4B580C0119_1692748993', 'date_time': '2023-08-23 00:03:13+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.738909 30.193169)', 'latitude': '30.193169', 'longitude': '-97.738909', 'address': 'nuckols crossing rd / e stassney ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:13'}, {'timestamp': '1692749009000000000', 'traffic_report_id': '634DE0A75896238BFD3F5886F6062F00DA3D0B56_1692749009', 'date_time': '2023-08-23 00:03:29+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.790941 30.167145)', 'latitude': '30.167145', 'longitude': '-97.790941', 'address': 'w slaughter ln / cullen ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:29'}, {'timestamp': '1692749887000000000', 'traffic_report_id': 'EBA90709ED04EB27E4A042727D7DD308E44389E4_1692749887', 'date_time': '2023-08-23 00:18:07+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.691583 30.370783)', 'latitude': '30.370783', 'longitude': '-97.691583', 'address': '600 masterson pass', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:18:07'}, {'timestamp': '1692751163000000000', 'traffic_report_id': '9D634E9D726305D5B9A7D2E527F6C49DD3603F4F_1692751163', 'date_time': '2023-08-23 00:39:23+00:00', 'issue_reported': 'collision with injury', 'location': 'POINT(-97.61178 30.102795)', 'latitude': '30.102795', 'longitude': '-97.61178', 'address': 'fm 812 rd / doyle rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:39:23'}, {'timestamp': '1692751987000000000', 'traffic_report_id': '301F839B74B67350B1BDC01050369AEC1F36E0D2_1692751987', 'date_time': '2023-08-23 00:53:07+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.691413 30.328075)', 'latitude': '30.328075', 'longitude': '-97.691413', 'address': '1308 fairbanks dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:53:07'}, {'timestamp': '1692752143000000000', 'traffic_report_id': '2B80090196FBBD61985EA7F2FC5C2F6AA4E1F134_1692752143', 'date_time': '2023-08-23 00:55:43+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.728493 30.235959)', 'latitude': '30.235959', 'longitude': '-97.728493', 'address': 'burton dr / woodland ave', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:55:43'}, {'timestamp': '1692753489000000000', 'traffic_report_id': '1E768A21723E530122240FA219BFF8C3365F40B2_1692753489', 'date_time': '2023-08-23 01:18:09+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.708554 30.310245)', 'latitude': '30.310245', 'longitude': '-97.708554', 'address': '5201-5217 cameron rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:09'}, {'timestamp': '1692753535000000000', 'traffic_report_id': '509F6CCBC5A85A0D07F32BFF32186163BA8301B8_1692753535', 'date_time': '2023-08-23 01:18:55+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.73408 30.26906)', 'latitude': '30.26906', 'longitude': '-97.73408', 'address': '900 n ih 35 svrd sb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:55'}  ... displaying 10 of 146 total bound parameter sets ...  {'timestamp': '1692834773000000000', 'traffic_report_id': '3C457CE18C2E37A4437E0201076AD638367EF0EA_1692834773', 'date_time': '2023-08-23 23:52:53+00:00', 'issue_reported': 'crash service', 'location': 'POINT(-97.774726 30.183637)', 'latitude': '30.183637', 'longitude': '-97.774726', 'address': '7301 s ih 35 svrd nb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:52:53'}, {'timestamp': '1692834818000000000', 'traffic_report_id': '0F23EB04FA3D66BCE3CB03DE0629AC1B4FD32BBB_1692834818', 'date_time': '2023-08-23 23:53:38+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.742505 30.443741)', 'latitude': '30.443741', 'longitude': '-97.742505', 'address': '6101-6217 mc neil dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:53:38'})]
[2023-08-30T20:36:04.862+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:36:04.935+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:36:04.950+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:36:04.958+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T203603, end_date=20230830T203604
[2023-08-30T20:36:04.989+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 23 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 445)
[2023-08-30T20:36:05.018+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:36:05.037+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:50:35.739+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:35.756+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:50:35.764+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T20:50:35.765+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:50:35.779+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T20:50:35.786+0000] {standard_task_runner.py:57} INFO - Started process 478 to run task
[2023-08-30T20:50:35.796+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpn6tbrew7']
[2023-08-30T20:50:35.802+0000] {standard_task_runner.py:85} INFO - Job 24: Subtask export_data_to_db
[2023-08-30T20:50:35.832+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:35.885+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host 8f66711a2898
[2023-08-30T20:50:35.907+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:36.077+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T20:50:36.188+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:50:36.199+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:50:36.239+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:50:42.610+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:50:42.613+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:50:42.615+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:50:42.616+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:50:42.618+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:50:42.619+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:50:42.621+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:50:42.622+0000] {subprocess.py:93} INFO - psycopg2.errors.NumericValueOutOfRange: value "1692748993000000000" is out of range for type integer
[2023-08-30T20:50:42.623+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169274899...
[2023-08-30T20:50:42.624+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:50:42.625+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.626+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.626+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:50:42.627+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.628+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:50:42.629+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T20:50:42.630+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:50:42.631+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T20:50:42.632+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:50:42.634+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:50:42.635+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:50:42.637+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:50:42.638+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:50:42.639+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:50:42.640+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:50:42.641+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:50:42.642+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:50:42.643+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:50:42.644+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:50:42.645+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:50:42.646+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:50:42.647+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:50:42.648+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:50:42.649+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:50:42.650+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:50:42.652+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:50:42.654+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:50:42.656+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:50:42.657+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:50:42.658+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:50:42.660+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:50:42.661+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:50:42.662+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:50:42.663+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:50:42.665+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:50:42.666+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:50:42.667+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:50:42.668+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:50:42.670+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:50:42.671+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:50:42.672+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:50:42.677+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) value "1692748993000000000" is out of range for type integer
[2023-08-30T20:50:42.680+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169274899...
[2023-08-30T20:50:42.681+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:50:42.682+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.683+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:50:42.684+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1692748993000000000', 'traffic_report_id': '9A6B59DA46371D86EB75259C956AEE4B580C0119_1692748993', 'date_time': '2023-08-23 00:03:13+00:00', 'issue_reported': 'crash service', 'latitude': '30.193169', 'longitude': '-97.738909', 'address': 'nuckols crossing rd / e stassney ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:13'}, {'timestamp': '1692749009000000000', 'traffic_report_id': '634DE0A75896238BFD3F5886F6062F00DA3D0B56_1692749009', 'date_time': '2023-08-23 00:03:29+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.167145', 'longitude': '-97.790941', 'address': 'w slaughter ln / cullen ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:29'}, {'timestamp': '1692749887000000000', 'traffic_report_id': 'EBA90709ED04EB27E4A042727D7DD308E44389E4_1692749887', 'date_time': '2023-08-23 00:18:07+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.370783', 'longitude': '-97.691583', 'address': '600 masterson pass', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:18:07'}, {'timestamp': '1692751163000000000', 'traffic_report_id': '9D634E9D726305D5B9A7D2E527F6C49DD3603F4F_1692751163', 'date_time': '2023-08-23 00:39:23+00:00', 'issue_reported': 'collision with injury', 'latitude': '30.102795', 'longitude': '-97.61178', 'address': 'fm 812 rd / doyle rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:39:23'}, {'timestamp': '1692751987000000000', 'traffic_report_id': '301F839B74B67350B1BDC01050369AEC1F36E0D2_1692751987', 'date_time': '2023-08-23 00:53:07+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.328075', 'longitude': '-97.691413', 'address': '1308 fairbanks dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:53:07'}, {'timestamp': '1692752143000000000', 'traffic_report_id': '2B80090196FBBD61985EA7F2FC5C2F6AA4E1F134_1692752143', 'date_time': '2023-08-23 00:55:43+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.235959', 'longitude': '-97.728493', 'address': 'burton dr / woodland ave', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:55:43'}, {'timestamp': '1692753489000000000', 'traffic_report_id': '1E768A21723E530122240FA219BFF8C3365F40B2_1692753489', 'date_time': '2023-08-23 01:18:09+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.310245', 'longitude': '-97.708554', 'address': '5201-5217 cameron rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:09'}, {'timestamp': '1692753535000000000', 'traffic_report_id': '509F6CCBC5A85A0D07F32BFF32186163BA8301B8_1692753535', 'date_time': '2023-08-23 01:18:55+00:00', 'issue_reported': 'crash service', 'latitude': '30.26906', 'longitude': '-97.73408', 'address': '900 n ih 35 svrd sb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:55'}  ... displaying 10 of 146 total bound parameter sets ...  {'timestamp': '1692834773000000000', 'traffic_report_id': '3C457CE18C2E37A4437E0201076AD638367EF0EA_1692834773', 'date_time': '2023-08-23 23:52:53+00:00', 'issue_reported': 'crash service', 'latitude': '30.183637', 'longitude': '-97.774726', 'address': '7301 s ih 35 svrd nb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:52:53'}, {'timestamp': '1692834818000000000', 'traffic_report_id': '0F23EB04FA3D66BCE3CB03DE0629AC1B4FD32BBB_1692834818', 'date_time': '2023-08-23 23:53:38+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.443741', 'longitude': '-97.742505', 'address': '6101-6217 mc neil dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:53:38'})]
[2023-08-30T20:50:42.686+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T20:50:42.716+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:50:42.737+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:50:42.744+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T205035, end_date=20230830T205042
[2023-08-30T20:50:42.763+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 24 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 478)
[2023-08-30T20:50:42.800+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:50:42.828+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T21:09:59.343+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:09:59.369+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T21:09:59.380+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [queued]>
[2023-08-30T21:09:59.381+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T21:09:59.398+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-24 00:00:00+00:00
[2023-08-30T21:09:59.408+0000] {standard_task_runner.py:57} INFO - Started process 449 to run task
[2023-08-30T21:09:59.424+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-24T00:00:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpv8fgbrax']
[2023-08-30T21:09:59.448+0000] {standard_task_runner.py:85} INFO - Job 23: Subtask export_data_to_db
[2023-08-30T21:09:59.552+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:10:00.023+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-24T00:00:00+00:00 [running]> on host cbc745b7550b
[2023-08-30T21:10:00.302+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:10:03.074+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-24T00:00:00+00:00'
[2023-08-30T21:10:03.593+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T21:10:03.647+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-24 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T21:10:04.054+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T21:10:30.201+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:10:30.208+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:10:30.214+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:10:30.216+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:10:30.219+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:10:30.222+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:10:30.225+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:10:30.227+0000] {subprocess.py:93} INFO - psycopg2.errors.StringDataRightTruncation: value too long for type character varying(20)
[2023-08-30T21:10:30.229+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.232+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.235+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T21:10:30.237+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.239+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:10:30.241+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T21:10:30.242+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T21:10:30.245+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T21:10:30.246+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T21:10:30.248+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T21:10:30.253+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T21:10:30.255+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T21:10:30.258+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T21:10:30.260+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T21:10:30.262+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T21:10:30.263+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:10:30.265+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:10:30.266+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T21:10:30.268+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T21:10:30.271+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T21:10:30.274+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T21:10:30.276+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T21:10:30.278+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T21:10:30.285+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T21:10:30.289+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T21:10:30.292+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T21:10:30.295+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T21:10:30.297+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T21:10:30.300+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T21:10:30.302+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T21:10:30.304+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T21:10:30.309+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T21:10:30.312+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T21:10:30.315+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:10:30.317+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:10:30.319+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:10:30.324+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:10:30.329+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:10:30.336+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:10:30.337+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:10:30.339+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:10:30.340+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(20)
[2023-08-30T21:10:30.341+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.343+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T21:10:30.346+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1692748993000000000', 'traffic_report_id': '9A6B59DA46371D86EB75259C956AEE4B580C0119_1692748993', 'date_time': '2023-08-23 00:03:13+00:00', 'issue_reported': 'crash service', 'latitude': '30.193169', 'longitude': '-97.738909', 'address': 'nuckols crossing rd / e stassney ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:13'}, {'timestamp': '1692749009000000000', 'traffic_report_id': '634DE0A75896238BFD3F5886F6062F00DA3D0B56_1692749009', 'date_time': '2023-08-23 00:03:29+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.167145', 'longitude': '-97.790941', 'address': 'w slaughter ln / cullen ln', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:03:29'}, {'timestamp': '1692749887000000000', 'traffic_report_id': 'EBA90709ED04EB27E4A042727D7DD308E44389E4_1692749887', 'date_time': '2023-08-23 00:18:07+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.370783', 'longitude': '-97.691583', 'address': '600 masterson pass', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:18:07'}, {'timestamp': '1692751163000000000', 'traffic_report_id': '9D634E9D726305D5B9A7D2E527F6C49DD3603F4F_1692751163', 'date_time': '2023-08-23 00:39:23+00:00', 'issue_reported': 'collision with injury', 'latitude': '30.102795', 'longitude': '-97.61178', 'address': 'fm 812 rd / doyle rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:39:23'}, {'timestamp': '1692751987000000000', 'traffic_report_id': '301F839B74B67350B1BDC01050369AEC1F36E0D2_1692751987', 'date_time': '2023-08-23 00:53:07+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.328075', 'longitude': '-97.691413', 'address': '1308 fairbanks dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:53:07'}, {'timestamp': '1692752143000000000', 'traffic_report_id': '2B80090196FBBD61985EA7F2FC5C2F6AA4E1F134_1692752143', 'date_time': '2023-08-23 00:55:43+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.235959', 'longitude': '-97.728493', 'address': 'burton dr / woodland ave', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '00:55:43'}, {'timestamp': '1692753489000000000', 'traffic_report_id': '1E768A21723E530122240FA219BFF8C3365F40B2_1692753489', 'date_time': '2023-08-23 01:18:09+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.310245', 'longitude': '-97.708554', 'address': '5201-5217 cameron rd', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:09'}, {'timestamp': '1692753535000000000', 'traffic_report_id': '509F6CCBC5A85A0D07F32BFF32186163BA8301B8_1692753535', 'date_time': '2023-08-23 01:18:55+00:00', 'issue_reported': 'crash service', 'latitude': '30.26906', 'longitude': '-97.73408', 'address': '900 n ih 35 svrd sb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '01:18:55'}  ... displaying 10 of 146 total bound parameter sets ...  {'timestamp': '1692834773000000000', 'traffic_report_id': '3C457CE18C2E37A4437E0201076AD638367EF0EA_1692834773', 'date_time': '2023-08-23 23:52:53+00:00', 'issue_reported': 'crash service', 'latitude': '30.183637', 'longitude': '-97.774726', 'address': '7301 s ih 35 svrd nb', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:52:53'}, {'timestamp': '1692834818000000000', 'traffic_report_id': '0F23EB04FA3D66BCE3CB03DE0629AC1B4FD32BBB_1692834818', 'date_time': '2023-08-23 23:53:38+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.443741', 'longitude': '-97.742505', 'address': '6101-6217 mc neil dr', 'weekday': 'Wednesday', 'date': '2023-08-23', 'time': '23:53:38'})]
[2023-08-30T21:10:30.349+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T21:10:30.352+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T21:10:30.379+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T21:10:30.395+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230824T000000, start_date=20230830T210959, end_date=20230830T211030
[2023-08-30T21:10:30.480+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 23 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 449)
[2023-08-30T21:10:30.512+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T21:10:30.551+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
