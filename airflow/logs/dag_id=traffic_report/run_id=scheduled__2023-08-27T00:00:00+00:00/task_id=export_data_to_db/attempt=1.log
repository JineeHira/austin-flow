[2023-08-30T19:31:42.303+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:31:42.315+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:31:42.325+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:31:42.332+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T19:31:42.344+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:31:42.349+0000] {standard_task_runner.py:57} INFO - Started process 308 to run task
[2023-08-30T19:31:42.352+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpv6rvnu74']
[2023-08-30T19:31:42.357+0000] {standard_task_runner.py:85} INFO - Job 14: Subtask export_data_to_db
[2023-08-30T19:31:42.374+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:31:42.420+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host f6bcf103ff79
[2023-08-30T19:31:42.433+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:31:42.510+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:31:42.515+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:31:42.518+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:31:42.532+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:31:43.058+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:31:43.059+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:31:43.060+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:31:43.061+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:31:43.063+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:31:43.064+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:31:43.116+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:31:43.133+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:31:43.139+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T193142, end_date=20230830T193143
[2023-08-30T19:31:43.178+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 14 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 308)
[2023-08-30T19:31:43.211+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:31:43.232+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:42:02.054+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:42:02.062+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:42:02.075+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:42:02.076+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T19:42:02.101+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:42:02.108+0000] {standard_task_runner.py:57} INFO - Started process 384 to run task
[2023-08-30T19:42:02.116+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpusw1z_ha']
[2023-08-30T19:42:02.119+0000] {standard_task_runner.py:85} INFO - Job 17: Subtask export_data_to_db
[2023-08-30T19:42:02.147+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:42:02.194+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 81eeb4b7c8a9
[2023-08-30T19:42:02.224+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:42:02.310+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:42:02.312+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:42:02.314+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:42:02.331+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:42:02.889+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:42:02.890+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:42:02.891+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:42:02.893+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:42:02.895+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:42:02.896+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:42:02.940+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:42:02.957+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:42:02.961+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T194202, end_date=20230830T194202
[2023-08-30T19:42:02.984+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 17 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 384)
[2023-08-30T19:42:03.017+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:42:03.036+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:51:05.602+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:51:05.624+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:51:05.639+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:51:05.641+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T19:51:05.731+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:51:05.747+0000] {standard_task_runner.py:57} INFO - Started process 362 to run task
[2023-08-30T19:51:05.784+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmp_yonshp6']
[2023-08-30T19:51:05.829+0000] {standard_task_runner.py:85} INFO - Job 14: Subtask export_data_to_db
[2023-08-30T19:51:07.083+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:51:08.540+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 206ecb1dc8df
[2023-08-30T19:51:14.160+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:51:22.890+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:51:22.895+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:51:22.900+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:51:22.924+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:51:33.985+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:51:33.991+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T19:51:33.994+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T19:51:33.995+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 22, in main
[2023-08-30T19:51:33.998+0000] {subprocess.py:93} INFO -     with open(filename, encoding='utf-8') as csvf:
[2023-08-30T19:51:34.000+0000] {subprocess.py:93} INFO - FileNotFoundError: [Errno 2] No such file or directory: '/opt/***/dags/data/traffic_2023-08-26.csv'
[2023-08-30T19:51:34.107+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:51:34.147+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:51:34.162+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T195105, end_date=20230830T195134
[2023-08-30T19:51:34.191+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 14 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 362)
[2023-08-30T19:51:34.228+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:51:34.245+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:54:33.288+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:54:33.314+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:54:33.349+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:54:33.352+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T19:54:33.380+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:54:33.385+0000] {standard_task_runner.py:57} INFO - Started process 317 to run task
[2023-08-30T19:54:33.392+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpith6u4lz']
[2023-08-30T19:54:33.396+0000] {standard_task_runner.py:85} INFO - Job 15: Subtask export_data_to_db
[2023-08-30T19:54:33.419+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:54:33.468+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 86f9e97d6c70
[2023-08-30T19:54:33.490+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:54:33.580+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:54:33.584+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:54:33.586+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:54:33.605+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:54:34.606+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:54:34.612+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
[2023-08-30T19:54:34.614+0000] {subprocess.py:93} INFO -     self.dialect.do_execute(
[2023-08-30T19:54:34.615+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
[2023-08-30T19:54:34.616+0000] {subprocess.py:93} INFO -     cursor.execute(statement, parameters)
[2023-08-30T19:54:34.617+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedTable: relation "traffic_report" does not exist
[2023-08-30T19:54:34.618+0000] {subprocess.py:93} INFO - LINE 1: DELETE FROM traffic_report where date_time >= timestamp '202...
[2023-08-30T19:54:34.621+0000] {subprocess.py:93} INFO -                     ^
[2023-08-30T19:54:34.624+0000] {subprocess.py:93} INFO - 
[2023-08-30T19:54:34.628+0000] {subprocess.py:93} INFO - 
[2023-08-30T19:54:34.630+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T19:54:34.631+0000] {subprocess.py:93} INFO - 
[2023-08-30T19:54:34.632+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:54:34.633+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T19:54:34.634+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T19:54:34.635+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T19:54:34.636+0000] {subprocess.py:93} INFO -     session.execute("DELETE FROM traffic_report where date_time >= timestamp '{} 00:00:00' and date_time < timestamp'{} 00:00:00'".format(yesterday, fetch_date))
[2023-08-30T19:54:34.637+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1717, in execute
[2023-08-30T19:54:34.638+0000] {subprocess.py:93} INFO -     result = conn._execute_20(statement, params or {}, execution_options)
[2023-08-30T19:54:34.642+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T19:54:34.643+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T19:54:34.648+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T19:54:34.649+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T19:54:34.650+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T19:54:34.651+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T19:54:34.656+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T19:54:34.660+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T19:54:34.661+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T19:54:34.662+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T19:54:34.664+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T19:54:34.665+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T19:54:34.667+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
[2023-08-30T19:54:34.668+0000] {subprocess.py:93} INFO -     self.dialect.do_execute(
[2023-08-30T19:54:34.669+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
[2023-08-30T19:54:34.670+0000] {subprocess.py:93} INFO -     cursor.execute(statement, parameters)
[2023-08-30T19:54:34.671+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "traffic_report" does not exist
[2023-08-30T19:54:34.672+0000] {subprocess.py:93} INFO - LINE 1: DELETE FROM traffic_report where date_time >= timestamp '202...
[2023-08-30T19:54:34.674+0000] {subprocess.py:93} INFO -                     ^
[2023-08-30T19:54:34.675+0000] {subprocess.py:93} INFO - 
[2023-08-30T19:54:34.676+0000] {subprocess.py:93} INFO - [SQL: DELETE FROM traffic_report where date_time >= timestamp '2023-08-26 00:00:00' and date_time < timestamp'2023-08-27 00:00:00']
[2023-08-30T19:54:34.677+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T19:54:34.731+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:54:34.756+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:54:34.764+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T195433, end_date=20230830T195434
[2023-08-30T19:54:34.789+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 15 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 317)
[2023-08-30T19:54:34.808+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:54:34.828+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:05:58.392+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:05:58.413+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:05:58.430+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:05:58.432+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T20:05:58.447+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:05:58.452+0000] {standard_task_runner.py:57} INFO - Started process 541 to run task
[2023-08-30T20:05:58.458+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '25', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmptfwi04cn']
[2023-08-30T20:05:58.461+0000] {standard_task_runner.py:85} INFO - Job 25: Subtask export_data_to_db
[2023-08-30T20:05:58.480+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:05:58.519+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 3938d7abd9ff
[2023-08-30T20:05:58.533+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:05:58.594+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:05:58.596+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:05:58.598+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:05:58.609+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:05:59.250+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:05:59.253+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:05:59.254+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:05:59.256+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:05:59.258+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:05:59.260+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:05:59.261+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:05:59.263+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:05:59.265+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:05:59.267+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:05:59.268+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:05:59.270+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:05:59.273+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:05:59.275+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:05:59.277+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:05:59.278+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:05:59.280+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:05:59.282+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:05:59.283+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:05:59.285+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:05:59.288+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:05:59.290+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:05:59.292+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:05:59.294+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:05:59.295+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:05:59.297+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:05:59.298+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:05:59.299+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:05:59.300+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:05:59.302+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:05:59.303+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:05:59.305+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:05:59.307+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:05:59.309+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:05:59.310+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:05:59.312+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:05:59.313+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:05:59.314+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:05:59.316+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:05:59.317+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:05:59.318+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:05:59.320+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:05:59.321+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:05:59.322+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:05:59.323+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:05:59.324+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:05:59.325+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:05:59.326+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:05:59.327+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:05:59.328+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:05:59.329+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:05:59.330+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:05:59.331+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:05:59.332+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:05:59.333+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:05:59.334+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:05:59.336+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:05:59.337+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:05:59.338+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.848128 30.330623)', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.700579 30.42974)', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.816214 30.232731)', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.751775 30.21483)', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.675404 30.406659)', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.553275 30.259891)', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.47028 30.453754)', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.696024 30.439961)', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.79708 30.137794)', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'location': 'POINT(-97.736741 30.23255)', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:05:59.340+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:05:59.346+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:05:59.359+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:05:59.363+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T200558, end_date=20230830T200559
[2023-08-30T20:05:59.376+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 25 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 541)
[2023-08-30T20:05:59.393+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:05:59.409+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:33:59.742+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:33:59.754+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:33:59.771+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:33:59.773+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T20:33:59.792+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:33:59.806+0000] {standard_task_runner.py:57} INFO - Started process 339 to run task
[2023-08-30T20:33:59.810+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpmk_zgqd1']
[2023-08-30T20:33:59.814+0000] {standard_task_runner.py:85} INFO - Job 19: Subtask export_data_to_db
[2023-08-30T20:33:59.838+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:33:59.900+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 961f38e8363e
[2023-08-30T20:33:59.930+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:34:00.046+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:34:00.049+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:34:00.050+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:34:00.070+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:34:01.057+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:34:01.059+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:34:01.061+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:34:01.062+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:34:01.064+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:34:01.068+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:34:01.070+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:34:01.072+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:34:01.074+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:34:01.075+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:34:01.076+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:34:01.077+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:34:01.078+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:34:01.079+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:34:01.081+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:34:01.087+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:34:01.088+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:34:01.090+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:34:01.093+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:34:01.095+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:34:01.096+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:34:01.098+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:34:01.100+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:34:01.102+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:34:01.104+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:34:01.107+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:34:01.111+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:34:01.113+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:34:01.115+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:34:01.117+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:34:01.119+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:34:01.120+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:34:01.121+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:34:01.122+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:34:01.124+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:34:01.126+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:34:01.127+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:34:01.128+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:34:01.129+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:34:01.131+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:34:01.132+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:34:01.133+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:34:01.136+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:34:01.138+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:34:01.140+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:34:01.142+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:34:01.145+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:34:01.146+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:34:01.147+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:34:01.149+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:34:01.150+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:34:01.151+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:34:01.155+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:34:01.156+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:34:01.157+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:34:01.159+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:34:01.160+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:34:01.162+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:34:01.164+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.848128 30.330623)', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.700579 30.42974)', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.816214 30.232731)', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.751775 30.21483)', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.675404 30.406659)', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.553275 30.259891)', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.47028 30.453754)', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.696024 30.439961)', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.79708 30.137794)', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'location': 'POINT(-97.736741 30.23255)', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:34:01.167+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:34:01.288+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:34:01.316+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:34:01.321+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T203359, end_date=20230830T203401
[2023-08-30T20:34:01.346+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 19 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 339)
[2023-08-30T20:34:01.401+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:34:01.425+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:48:32.606+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:48:32.617+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:48:32.632+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:48:32.634+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T20:48:32.653+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:48:32.659+0000] {standard_task_runner.py:57} INFO - Started process 396 to run task
[2023-08-30T20:48:32.673+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpmndiwuzd']
[2023-08-30T20:48:32.681+0000] {standard_task_runner.py:85} INFO - Job 18: Subtask export_data_to_db
[2023-08-30T20:48:32.702+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:48:32.759+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 8f66711a2898
[2023-08-30T20:48:32.786+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:48:32.865+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:48:32.870+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:48:32.871+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:48:32.884+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:48:33.511+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:48:33.512+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:48:33.513+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:48:33.515+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:48:33.516+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:48:33.517+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:48:33.518+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:48:33.519+0000] {subprocess.py:93} INFO - psycopg2.errors.NumericValueOutOfRange: value "1693008631000000000" is out of range for type integer
[2023-08-30T20:48:33.520+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169300863...
[2023-08-30T20:48:33.522+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:48:33.525+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:48:33.532+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:48:33.537+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:48:33.541+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:48:33.543+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:48:33.544+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T20:48:33.549+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:48:33.550+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T20:48:33.553+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:48:33.554+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:48:33.555+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:48:33.558+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:48:33.560+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:48:33.562+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:48:33.564+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:48:33.566+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:48:33.570+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:48:33.573+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:48:33.575+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:48:33.577+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:48:33.578+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:48:33.582+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:48:33.583+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:48:33.584+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:48:33.586+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:48:33.587+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:48:33.588+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:48:33.589+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:48:33.590+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:48:33.597+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:48:33.598+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:48:33.600+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:48:33.602+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:48:33.603+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:48:33.604+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:48:33.606+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:48:33.610+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:48:33.611+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:48:33.613+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:48:33.616+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:48:33.618+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:48:33.619+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) value "1693008631000000000" is out of range for type integer
[2023-08-30T20:48:33.621+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169300863...
[2023-08-30T20:48:33.623+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:48:33.625+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:48:33.626+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:48:33.627+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:48:33.629+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T20:48:33.631+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:48:33.660+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:48:33.668+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T204832, end_date=20230830T204833
[2023-08-30T20:48:33.687+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 18 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 396)
[2023-08-30T20:48:33.719+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:48:33.736+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T21:07:56.279+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:07:56.287+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:07:56.298+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:07:56.299+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T21:07:56.313+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T21:07:56.319+0000] {standard_task_runner.py:57} INFO - Started process 366 to run task
[2023-08-30T21:07:56.325+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpxh_kp9r7']
[2023-08-30T21:07:56.329+0000] {standard_task_runner.py:85} INFO - Job 20: Subtask export_data_to_db
[2023-08-30T21:07:56.348+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:07:56.398+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host cbc745b7550b
[2023-08-30T21:07:56.430+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:07:56.508+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T21:07:56.521+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T21:07:56.523+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T21:07:56.546+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T21:07:57.222+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:07:57.225+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:07:57.226+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:07:57.229+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:07:57.231+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:07:57.234+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:07:57.239+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:07:57.242+0000] {subprocess.py:93} INFO - psycopg2.errors.StringDataRightTruncation: value too long for type character varying(20)
[2023-08-30T21:07:57.244+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:07:57.245+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:07:57.247+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T21:07:57.249+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:07:57.251+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:07:57.275+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T21:07:57.277+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T21:07:57.284+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T21:07:57.287+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T21:07:57.290+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T21:07:57.295+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T21:07:57.297+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T21:07:57.298+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T21:07:57.300+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T21:07:57.303+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T21:07:57.305+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:07:57.307+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:07:57.310+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T21:07:57.315+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T21:07:57.316+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T21:07:57.318+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T21:07:57.319+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T21:07:57.321+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T21:07:57.325+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T21:07:57.326+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T21:07:57.328+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T21:07:57.329+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T21:07:57.331+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T21:07:57.338+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T21:07:57.340+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T21:07:57.342+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T21:07:57.343+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T21:07:57.344+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T21:07:57.345+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:07:57.347+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:07:57.352+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:07:57.357+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:07:57.362+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:07:57.369+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:07:57.371+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:07:57.374+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:07:57.377+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(20)
[2023-08-30T21:07:57.379+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:07:57.381+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T21:07:57.393+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T21:07:57.400+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T21:07:57.404+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T21:07:57.450+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T21:07:57.461+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T210756, end_date=20230830T210757
[2023-08-30T21:07:57.483+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 20 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 366)
[2023-08-30T21:07:57.504+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T21:07:57.525+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T21:17:15.118+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:17:15.126+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:17:15.142+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:17:15.143+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-30T21:17:15.157+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T21:17:15.163+0000] {standard_task_runner.py:57} INFO - Started process 408 to run task
[2023-08-30T21:17:15.174+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpzlbv98tc']
[2023-08-30T21:17:15.177+0000] {standard_task_runner.py:85} INFO - Job 17: Subtask export_data_to_db
[2023-08-30T21:17:15.197+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:17:15.241+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 5b9f14bf20e0
[2023-08-30T21:17:15.256+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:17:15.336+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T21:17:15.343+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T21:17:15.344+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T21:17:15.365+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T21:17:16.150+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2023-08-30T21:17:16.190+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T211715, end_date=20230830T211716
[2023-08-30T21:17:16.226+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-08-30T21:17:16.250+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
