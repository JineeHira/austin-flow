[2023-08-30T19:33:43.634+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:33:43.643+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:33:43.652+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:33:43.653+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:33:43.664+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:33:43.669+0000] {standard_task_runner.py:57} INFO - Started process 407 to run task
[2023-08-30T19:33:43.671+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmp4ri_6gc8']
[2023-08-30T19:33:43.674+0000] {standard_task_runner.py:85} INFO - Job 22: Subtask export_data_to_db
[2023-08-30T19:33:43.688+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:33:43.721+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host f6bcf103ff79
[2023-08-30T19:33:43.733+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:33:43.783+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:33:43.786+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:33:43.787+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:33:43.797+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:33:44.134+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:33:44.136+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:33:44.138+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:33:44.139+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:33:44.140+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:33:44.141+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:33:44.153+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:33:44.165+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:33:44.169+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T193343, end_date=20230830T193344
[2023-08-30T19:33:44.180+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 22 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 407)
[2023-08-30T19:33:44.213+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:33:44.231+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:44:05.373+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:05.385+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:44:05.394+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:44:05.396+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:44:05.413+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:44:05.424+0000] {standard_task_runner.py:57} INFO - Started process 469 to run task
[2023-08-30T19:44:05.426+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpp6xy4jvb']
[2023-08-30T19:44:05.433+0000] {standard_task_runner.py:85} INFO - Job 20: Subtask export_data_to_db
[2023-08-30T19:44:05.556+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:11.345+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 81eeb4b7c8a9
[2023-08-30T19:44:11.390+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:44:11.556+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:44:11.572+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:44:11.575+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:44:11.601+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:44:13.574+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:44:13.579+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 6, in <module>
[2023-08-30T19:44:13.581+0000] {subprocess.py:93} INFO -     from model import Connection, Traffic
[2023-08-30T19:44:13.582+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/model.py", line 5, in <module>
[2023-08-30T19:44:13.584+0000] {subprocess.py:93} INFO -     from geoalchemy2 import Geometry
[2023-08-30T19:44:13.585+0000] {subprocess.py:93} INFO - ModuleNotFoundError: No module named 'geoalchemy2'
[2023-08-30T19:44:13.642+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:44:13.707+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:44:13.719+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T194405, end_date=20230830T194413
[2023-08-30T19:44:13.745+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 20 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 469)
[2023-08-30T19:44:13.804+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:44:13.937+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T19:56:36.813+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:36.822+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:56:36.835+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T19:56:36.836+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T19:56:36.854+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T19:56:36.862+0000] {standard_task_runner.py:57} INFO - Started process 198 to run task
[2023-08-30T19:56:36.902+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmplc3dxo8a']
[2023-08-30T19:56:36.906+0000] {standard_task_runner.py:85} INFO - Job 26: Subtask export_data_to_db
[2023-08-30T19:56:36.942+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:36.994+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 86f9e97d6c70
[2023-08-30T19:56:37.015+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T19:56:37.109+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T19:56:37.111+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T19:56:37.113+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T19:56:37.137+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T19:56:37.984+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T19:56:37.986+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T19:56:37.987+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T19:56:37.988+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 22, in main
[2023-08-30T19:56:37.989+0000] {subprocess.py:93} INFO -     with open(filename, encoding='utf-8') as csvf:
[2023-08-30T19:56:37.990+0000] {subprocess.py:93} INFO - FileNotFoundError: [Errno 2] No such file or directory: '/opt/***/dags/data/dailytraffic_2023-08-26.csv'
[2023-08-30T19:56:38.085+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T19:56:38.097+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T19:56:38.102+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T195636, end_date=20230830T195638
[2023-08-30T19:56:38.117+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 26 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 198)
[2023-08-30T19:56:38.145+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T19:56:38.167+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:08:00.390+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.399+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:08:00.407+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:08:00.409+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:08:00.419+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:08:00.424+0000] {standard_task_runner.py:57} INFO - Started process 647 to run task
[2023-08-30T20:08:00.428+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '29', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpka3t4y61']
[2023-08-30T20:08:00.432+0000] {standard_task_runner.py:85} INFO - Job 29: Subtask export_data_to_db
[2023-08-30T20:08:00.446+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.485+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 3938d7abd9ff
[2023-08-30T20:08:00.496+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:08:00.551+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:08:00.555+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:08:00.557+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:08:00.568+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:08:01.188+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:08:01.190+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:08:01.191+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:08:01.193+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:08:01.194+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:08:01.195+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:08:01.196+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:08:01.198+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:08:01.199+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:08:01.201+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:08:01.202+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:08:01.203+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.205+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.206+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:08:01.208+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.209+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:08:01.211+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:08:01.213+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:08:01.214+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:08:01.215+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:08:01.216+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:08:01.217+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:08:01.219+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:08:01.220+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:08:01.221+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:08:01.223+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:08:01.225+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:08:01.226+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:08:01.227+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:08:01.228+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:08:01.233+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:08:01.235+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:08:01.236+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:08:01.237+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:08:01.238+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:08:01.239+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:08:01.241+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:08:01.242+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:08:01.244+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:08:01.245+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:08:01.247+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:08:01.252+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:08:01.255+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:08:01.256+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:08:01.260+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:08:01.262+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:08:01.264+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:08:01.266+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:08:01.268+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:08:01.269+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:08:01.270+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:08:01.271+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:08:01.273+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:08:01.277+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:08:01.280+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:08:01.284+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:08:01.285+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:08:01.287+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:08:01.288+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.848128 30.330623)', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.700579 30.42974)', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.816214 30.232731)', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.751775 30.21483)', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.675404 30.406659)', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.553275 30.259891)', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.47028 30.453754)', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.696024 30.439961)', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.79708 30.137794)', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'location': 'POINT(-97.736741 30.23255)', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:08:01.292+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:08:01.326+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:08:01.349+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:08:01.354+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T200800, end_date=20230830T200801
[2023-08-30T20:08:01.370+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 29 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 647)
[2023-08-30T20:08:01.413+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:08:01.430+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:36:03.740+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:03.755+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:36:03.772+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:36:03.773+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:36:03.795+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:36:03.800+0000] {standard_task_runner.py:57} INFO - Started process 448 to run task
[2023-08-30T20:36:03.805+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '25', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpw3019ue5']
[2023-08-30T20:36:03.812+0000] {standard_task_runner.py:85} INFO - Job 25: Subtask export_data_to_db
[2023-08-30T20:36:03.839+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:03.914+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 961f38e8363e
[2023-08-30T20:36:03.937+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:36:04.023+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:36:04.028+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:36:04.030+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:36:04.060+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:36:05.123+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:36:05.125+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:36:05.126+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:36:05.127+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:36:05.128+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:36:05.129+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:36:05.130+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:36:05.134+0000] {subprocess.py:93} INFO - psycopg2.errors.UndefinedFunction: function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:36:05.136+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:36:05.137+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:36:05.138+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:36:05.139+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:05.139+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:05.140+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:36:05.141+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:05.142+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:36:05.143+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 50, in <module>
[2023-08-30T20:36:05.144+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:36:05.147+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 41, in main
[2023-08-30T20:36:05.148+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:36:05.149+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:36:05.150+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:36:05.151+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:36:05.153+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:36:05.155+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:36:05.156+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:36:05.158+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:36:05.159+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:36:05.160+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:36:05.161+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:36:05.162+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:36:05.163+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:36:05.164+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:36:05.165+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:36:05.166+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:36:05.168+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:36:05.169+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:36:05.170+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:36:05.170+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:36:05.171+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:36:05.172+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:36:05.173+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:36:05.174+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:36:05.177+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:36:05.178+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:36:05.180+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:36:05.181+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:36:05.182+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:36:05.182+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:36:05.183+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:36:05.184+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:36:05.185+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:36:05.186+0000] {subprocess.py:93} INFO - sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function st_geomfromewkt(unknown) does not exist
[2023-08-30T20:36:05.187+0000] {subprocess.py:93} INFO - LINE 1: ...', '2023-08-26 00:10:31+00:00', 'traffic hazard', ST_GeomFro...
[2023-08-30T20:36:05.188+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:36:05.189+0000] {subprocess.py:93} INFO - HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[2023-08-30T20:36:05.194+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:36:05.196+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, location, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, ST_GeomFromEWKT(%(location)s), %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:36:05.197+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.848128 30.330623)', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.700579 30.42974)', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.816214 30.232731)', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.751775 30.21483)', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'location': 'POINT(-97.675404 30.406659)', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.553275 30.259891)', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'location': 'POINT(-97.47028 30.453754)', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'location': 'POINT(-97.696024 30.439961)', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'location': 'POINT(-97.79708 30.137794)', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'location': 'POINT(-97.736741 30.23255)', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:36:05.204+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/f405)
[2023-08-30T20:36:05.214+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:36:05.226+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:36:05.230+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T203603, end_date=20230830T203605
[2023-08-30T20:36:05.244+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 25 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 448)
[2023-08-30T20:36:05.280+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:36:05.296+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T20:50:35.812+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:35.843+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:50:35.860+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T20:50:35.863+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T20:50:35.896+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T20:50:35.909+0000] {standard_task_runner.py:57} INFO - Started process 482 to run task
[2023-08-30T20:50:35.923+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpgr_2rus2']
[2023-08-30T20:50:35.932+0000] {standard_task_runner.py:85} INFO - Job 26: Subtask export_data_to_db
[2023-08-30T20:50:35.967+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:36.298+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host 8f66711a2898
[2023-08-30T20:50:37.196+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T20:50:39.688+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T20:50:39.705+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T20:50:39.708+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T20:50:39.735+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T20:50:42.797+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:50:42.798+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:50:42.801+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:50:42.805+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:50:42.807+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:50:42.808+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:50:42.816+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:50:42.817+0000] {subprocess.py:93} INFO - psycopg2.errors.NumericValueOutOfRange: value "1693008631000000000" is out of range for type integer
[2023-08-30T20:50:42.819+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169300863...
[2023-08-30T20:50:42.820+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:50:42.821+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.823+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.824+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T20:50:42.825+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.826+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T20:50:42.827+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T20:50:42.829+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T20:50:42.830+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T20:50:42.832+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T20:50:42.833+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T20:50:42.835+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T20:50:42.838+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T20:50:42.842+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T20:50:42.844+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T20:50:42.848+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T20:50:42.851+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:50:42.856+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:50:42.859+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T20:50:42.861+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T20:50:42.863+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T20:50:42.864+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T20:50:42.865+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T20:50:42.866+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T20:50:42.868+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T20:50:42.870+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T20:50:42.876+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T20:50:42.879+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T20:50:42.881+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T20:50:42.882+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T20:50:42.884+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T20:50:42.888+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T20:50:42.889+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T20:50:42.891+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T20:50:42.893+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T20:50:42.898+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T20:50:42.899+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T20:50:42.903+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T20:50:42.905+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T20:50:42.907+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T20:50:42.908+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T20:50:42.909+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T20:50:42.910+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.NumericValueOutOfRange) value "1693008631000000000" is out of range for type integer
[2023-08-30T20:50:42.911+0000] {subprocess.py:93} INFO - LINE 1: ... longitude, address, weekday, date, time) VALUES ('169300863...
[2023-08-30T20:50:42.913+0000] {subprocess.py:93} INFO -                                                              ^
[2023-08-30T20:50:42.914+0000] {subprocess.py:93} INFO - 
[2023-08-30T20:50:42.915+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T20:50:42.917+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T20:50:42.920+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T20:50:42.922+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T20:50:42.942+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T20:50:42.949+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T205035, end_date=20230830T205042
[2023-08-30T20:50:42.965+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 26 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 482)
[2023-08-30T20:50:43.010+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T20:50:43.028+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-08-30T21:09:59.344+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:09:59.366+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:09:59.379+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [queued]>
[2023-08-30T21:09:59.381+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-08-30T21:09:59.400+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): export_data_to_db> on 2023-08-27 00:00:00+00:00
[2023-08-30T21:09:59.428+0000] {standard_task_runner.py:57} INFO - Started process 451 to run task
[2023-08-30T21:09:59.439+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'traffic_report', 'export_data_to_db', 'scheduled__2023-08-27T00:00:00+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/traffic_dag.py', '--cfg-path', '/tmp/tmpi36oa5pi']
[2023-08-30T21:09:59.453+0000] {standard_task_runner.py:85} INFO - Job 24: Subtask export_data_to_db
[2023-08-30T21:09:59.553+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:10:00.144+0000] {task_command.py:415} INFO - Running <TaskInstance: traffic_report.export_data_to_db scheduled__2023-08-27T00:00:00+00:00 [running]> on host cbc745b7550b
[2023-08-30T21:10:00.391+0000] {logging_mixin.py:151} WARNING - /home/***/.local/lib/python3.8/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2023-08-30T21:10:05.057+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='traffic_report' AIRFLOW_CTX_TASK_ID='export_data_to_db' AIRFLOW_CTX_EXECUTION_DATE='2023-08-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-27T00:00:00+00:00'
[2023-08-30T21:10:05.097+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2023-08-30T21:10:05.116+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/dags/data_to_db.py --date 2023-08-27 --connection postgresql+psycopg2://***:***@postgres/***']
[2023-08-30T21:10:05.190+0000] {subprocess.py:86} INFO - Output:
[2023-08-30T21:10:30.228+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:10:30.231+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:10:30.234+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:10:30.237+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:10:30.239+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:10:30.242+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:10:30.244+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:10:30.249+0000] {subprocess.py:93} INFO - psycopg2.errors.StringDataRightTruncation: value too long for type character varying(20)
[2023-08-30T21:10:30.253+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.255+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.259+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2023-08-30T21:10:30.262+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.267+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-08-30T21:10:30.271+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 49, in <module>
[2023-08-30T21:10:30.274+0000] {subprocess.py:93} INFO -     main(args.date, args.connection)
[2023-08-30T21:10:30.275+0000] {subprocess.py:93} INFO -   File "/opt/***/dags/data_to_db.py", line 40, in main
[2023-08-30T21:10:30.276+0000] {subprocess.py:93} INFO -     session.bulk_save_objects(data_insert)
[2023-08-30T21:10:30.277+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3705, in bulk_save_objects
[2023-08-30T21:10:30.283+0000] {subprocess.py:93} INFO -     self._bulk_save_mappings(
[2023-08-30T21:10:30.285+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3913, in _bulk_save_mappings
[2023-08-30T21:10:30.290+0000] {subprocess.py:93} INFO -     transaction.rollback(_capture_exception=True)
[2023-08-30T21:10:30.291+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
[2023-08-30T21:10:30.295+0000] {subprocess.py:93} INFO -     compat.raise_(
[2023-08-30T21:10:30.296+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:10:30.298+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:10:30.302+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 3901, in _bulk_save_mappings
[2023-08-30T21:10:30.304+0000] {subprocess.py:93} INFO -     persistence._bulk_insert(
[2023-08-30T21:10:30.309+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 107, in _bulk_insert
[2023-08-30T21:10:30.311+0000] {subprocess.py:93} INFO -     _emit_insert_statements(
[2023-08-30T21:10:30.312+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/orm/persistence.py", line 1097, in _emit_insert_statements
[2023-08-30T21:10:30.315+0000] {subprocess.py:93} INFO -     c = connection._execute_20(
[2023-08-30T21:10:30.317+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1710, in _execute_20
[2023-08-30T21:10:30.321+0000] {subprocess.py:93} INFO -     return meth(self, args_10style, kwargs_10style, execution_options)
[2023-08-30T21:10:30.323+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
[2023-08-30T21:10:30.326+0000] {subprocess.py:93} INFO -     return connection._execute_clauseelement(
[2023-08-30T21:10:30.327+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
[2023-08-30T21:10:30.329+0000] {subprocess.py:93} INFO -     ret = self._execute_context(
[2023-08-30T21:10:30.331+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
[2023-08-30T21:10:30.333+0000] {subprocess.py:93} INFO -     self._handle_dbapi_exception(
[2023-08-30T21:10:30.334+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
[2023-08-30T21:10:30.336+0000] {subprocess.py:93} INFO -     util.raise_(
[2023-08-30T21:10:30.338+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
[2023-08-30T21:10:30.339+0000] {subprocess.py:93} INFO -     raise exception
[2023-08-30T21:10:30.340+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
[2023-08-30T21:10:30.341+0000] {subprocess.py:93} INFO -     self.dialect.do_executemany(
[2023-08-30T21:10:30.343+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
[2023-08-30T21:10:30.345+0000] {subprocess.py:93} INFO -     context._psycopg2_fetched_rows = xtras.execute_values(
[2023-08-30T21:10:30.347+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
[2023-08-30T21:10:30.349+0000] {subprocess.py:93} INFO -     cur.execute(b''.join(parts))
[2023-08-30T21:10:30.351+0000] {subprocess.py:93} INFO - sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(20)
[2023-08-30T21:10:30.353+0000] {subprocess.py:93} INFO - 
[2023-08-30T21:10:30.356+0000] {subprocess.py:93} INFO - [SQL: INSERT INTO traffic_report (timestamp, traffic_report_id, date_time, issue_reported, latitude, longitude, address, weekday, date, time) VALUES (%(timestamp)s, %(traffic_report_id)s, %(date_time)s, %(issue_reported)s, %(latitude)s, %(longitude)s, %(address)s, %(weekday)s, %(date)s, %(time)s)]
[2023-08-30T21:10:30.360+0000] {subprocess.py:93} INFO - [parameters: ({'timestamp': '1693008631000000000', 'traffic_report_id': 'D34531F611D60FFDC05468DF2EE6050B2F736741_1693008631', 'date_time': '2023-08-26 00:10:31+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.330623', 'longitude': '-97.848128', 'address': '1300-2002 river hills rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:10:31'}, {'timestamp': '1693009256000000000', 'traffic_report_id': 'A7DDD391B75EBF78821C49F97DEC245D2F39D816_1693009256', 'date_time': '2023-08-26 00:20:56+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.42974', 'longitude': '-97.700579', 'address': '13101-13161 burnet rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:20:56'}, {'timestamp': '1693009564000000000', 'traffic_report_id': 'DD8AA5B88B93A76D2064FDAC2DC1638C61F8C1E1_1693009564', 'date_time': '2023-08-26 00:26:04+00:00', 'issue_reported': 'collision', 'latitude': '30.232731', 'longitude': '-97.816214', 'address': '4823-4955 w us 290 hwy svrd eb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:26:04'}, {'timestamp': '1693010332000000000', 'traffic_report_id': '929D4B9DCC22EAA58C8E7D9895B5AC0E901A220C_1693010332', 'date_time': '2023-08-26 00:38:52+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.21483', 'longitude': '-97.751775', 'address': '0 s 35 nb to e ben white eb ramp', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:38:52'}, {'timestamp': '1693010792000000000', 'traffic_report_id': '8D93C9B0486A80BC7B6909DF5440D0C190ECCD4E_1693010792', 'date_time': '2023-08-26 00:46:32+00:00', 'issue_reported': 'crash urgent', 'latitude': '30.406659', 'longitude': '-97.675404', 'address': '12520-12536 n ih 35 svrd sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:46:32'}, {'timestamp': '1693010991000000000', 'traffic_report_id': '869655D8ABDC71EBDF8A999DE0B7E85B1FA69D28_1693010991', 'date_time': '2023-08-26 00:49:51+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.259891', 'longitude': '-97.553275', 'address': '7000-7709 taylor ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '00:49:51'}, {'timestamp': '1693011679000000000', 'traffic_report_id': '8DF5F9BFC9002F191A4EA6FF14D54B2BFE032BEA_1693011679', 'date_time': '2023-08-26 01:01:19+00:00', 'issue_reported': 'loose livestock', 'latitude': '30.453754', 'longitude': '-97.47028', 'address': 'pfluger berkman ln / n fm 973 rd', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:01:19'}, {'timestamp': '1693011826000000000', 'traffic_report_id': '233393C4B1323936F055066EC565931ADF738732_1693011826', 'date_time': '2023-08-26 01:03:46+00:00', 'issue_reported': 'collision', 'latitude': '30.439961', 'longitude': '-97.696024', 'address': '3313-3403 w wells branch pkwy', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '01:03:46'}  ... displaying 10 of 110 total bound parameter sets ...  {'timestamp': '1693092441000000000', 'traffic_report_id': 'B1D2E166D988E74123924D7BFF9CD30A63AFF067_1693092441', 'date_time': '2023-08-26 23:27:21+00:00', 'issue_reported': 'traffic hazard', 'latitude': '30.137794', 'longitude': '-97.79708', 'address': '11300 s ih 35 sb', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:27:21'}, {'timestamp': '1693093307000000000', 'traffic_report_id': '29F4D7BD70C46FD3B021272CB02151499CC6FDA1_1693093307', 'date_time': '2023-08-26 23:41:47+00:00', 'issue_reported': 'stalled vehicle', 'latitude': '30.23255', 'longitude': '-97.736741', 'address': '2100-2216 parker ln', 'weekday': 'Saturday', 'date': '2023-08-26', 'time': '23:41:47'})]
[2023-08-30T21:10:30.361+0000] {subprocess.py:93} INFO - (Background on this error at: https://sqlalche.me/e/14/9h9h)
[2023-08-30T21:10:30.469+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2023-08-30T21:10:30.509+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-08-30T21:10:30.515+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=traffic_report, task_id=export_data_to_db, execution_date=20230827T000000, start_date=20230830T210959, end_date=20230830T211030
[2023-08-30T21:10:30.554+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 24 for task export_data_to_db (Bash command failed. The command returned a non-zero exit code 1.; 451)
[2023-08-30T21:10:30.634+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-08-30T21:10:30.660+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
